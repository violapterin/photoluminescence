<main class="document">
<div class="section">
<p class="paragraph">
<span class="phrase"><span class="serif-roman">Given a ordered set</span> <span class="math"><span class="math-letter">\(\mathbb {T}\)</span></span> <span class="serif-roman">of integers, with size</span> <span class="math"><span class="math-plain">\(N\)</span></span><span class="serif-roman">,</span> <span class="serif-roman">return the number of such triplets chosen from</span> <span class="math"><span class="math-letter">\(\mathbb {T}\)</span></span> <span class="serif-roman">that can make up triangles, if we take them as lengths of the side.</span></span>
</p>
<p class="paragraph">
<span class="phrase"><span class="serif-roman">Constraints:</span></span>
</p>
<p class="paragraph">
<span class="phrase"><span class="math"><span class="math-plain">\(1\)</span><span class="math-sign">\(\:\leq\:\)</span><span class="math-plain">\(N\)</span><span class="math-sign">\(\:\leq\:\)</span><span class="math-plain">\(1\)</span><span class="math-plain">\(0\)</span><span class="math-plain">\(0\)</span><span class="math-plain">\(0\)</span><span class="math-plain">\(;\,\)</span></span></span>
</p>
<p class="paragraph">
<span class="phrase"><span class="math"><span class="math-plain">\(0\)</span><span class="math-sign">\(\:\leq\:\)</span><span class="math-triplet">\(\mathbb {T} _ {\left[ i \right]}\)</span><span class="math-sign">\(\:\leq\:\)</span><span class="math-plain">\(1\)</span><span class="math-plain">\(0\)</span><span class="math-plain">\(0\)</span><span class="math-plain">\(0\)</span><span class="math-plain">\(;\,\)</span></span></span>
</p>
</div>
<div class="section">
<p class="paragraph">
<span class="phrase"><span class="serif-roman">We want to find</span> <span class="math"><span class="math-plain">\(f\)</span><span class="math-bracket-square">\(\left[ \mathbb {T} \right]\)</span></span><span class="serif-roman">,</span> <span class="serif-roman">the number of valid triples of triangle number.</span></span> <span class="phrase"><span class="serif-roman">To slightly abuse notation, we may consider</span> <span class="math"><span class="math-letter">\(\mathbb {T}\)</span></span> <span class="serif-roman">to be an unordered set, when the order of elements doesn’t matter.</span></span> <span class="phrase"><span class="serif-roman">The brute-force approach would be exhausting all triplets in</span> <span class="math"><span class="math-letter">\(\mathbb {T}\)</span></span><span class="serif-roman">,</span> <span class="serif-roman">with complexity</span> <span class="math"><span class="math-letter">\(\mathscr {O}\)</span><span class="math-bracket-square">\(\left[ N ^ {3} \right]\)</span></span><span class="serif-roman">.</span></span>
</p>
<p class="paragraph">
<span class="phrase"><span class="serif-roman">How can we do better?</span></span> <span class="phrase"><span class="serif-roman">Let</span> <span class="math"><span class="math-letter">\(\mathbb {T}\)</span></span> <span class="serif-roman">be sorted, which takes</span> <span class="math"><span class="math-letter">\(\mathscr {O}\)</span><span class="math-bracket-square">\(\left[ N \,\mathrm {log}\, N \right]\)</span></span> <span class="serif-roman">.</span></span> <span class="phrase"><span class="serif-roman">Without loss of generality, let the triplet be</span> <span class="math"><span class="math-bracket-angle">\(\left\langle x ,\, y ,\, z \right\rangle\)</span></span> <span class="serif-roman">with</span> <span class="math"><span class="math-plain">\(x\)</span><span class="math-sign">\(\:\leq\:\)</span><span class="math-plain">\(y\)</span><span class="math-sign">\(\:\leq\:\)</span><span class="math-plain">\(z\)</span></span><span class="serif-roman">.</span></span> <span class="phrase"><span class="serif-roman">We only have to check:</span></span>
</p>
<p class="paragraph">
<span class="phrase"><span class="math"><span class="math-plain">\(x\)</span><span class="math-plain">\(+\)</span><span class="math-plain">\(y\)</span><span class="math-sign">\(\:&gt;\:\)</span><span class="math-plain">\(z\)</span><span class="math-plain">\(;\,\)</span></span></span>
</p>
<p class="paragraph">
<span class="phrase"><span class="serif-roman">Split cases of whether the biggest component</span> <span class="math"><span class="math-plain">\(z\)</span><span class="math-sign">\(\:\in\:\)</span><span class="math-letter">\(\mathbb {T}\)</span></span> <span class="serif-roman">is chosen.</span></span> <span class="phrase"><span class="serif-roman">Call</span> <span class="math"><span class="math-letter">\(\mathbb {S}\)</span><span class="math-sign">\(\:\equiv\:\)</span><span class="math-letter">\(\mathbb {T}\)</span><span class="math-sign">\(\backslash\)</span><span class="math-bracket-curly">\(\left\{ z \right\}\)</span></span><span class="serif-roman">.</span></span> <span class="phrase"><span class="serif-roman">If</span> <span class="math"><span class="math-plain">\(g\)</span><span class="math-bracket-square">\(\left[ z ,\, \mathbb {S} \right]\)</span></span> <span class="serif-roman">is the number of valid triples, in which</span> <span class="math"><span class="math-plain">\(z\)</span></span> <span class="serif-roman">must be chosen, then:</span></span>
</p>
<p class="paragraph">
<span class="phrase"><span class="math"><span class="math-plain">\(f\)</span><span class="math-bracket-square">\(\left[ \mathbb {T} \right]\)</span><span class="math-plain">\(\;=\;\)</span><span class="math-plain">\(g\)</span><span class="math-bracket-square">\(\left[ z ,\, \mathbb {S} \right]\)</span><span class="math-plain">\(+\)</span><span class="math-plain">\(f\)</span><span class="math-bracket-square">\(\left[ \mathbb {S} \right]\)</span></span></span>
</p>
<p class="paragraph">
<span class="phrase"><span class="serif-roman">We see that</span> <span class="math"><span class="math-plain">\(g\)</span><span class="math-bracket-square">\(\left[ z ,\, \mathbb {S} \right]\)</span></span> <span class="serif-roman">has complexity</span> <span class="math"><span class="math-letter">\(\mathscr {O}\)</span><span class="math-bracket-square">\(\left[ N \right]\)</span></span> <span class="serif-roman">.</span></span> <span class="phrase"><span class="serif-roman">Indeed, fix</span> <span class="math"><span class="math-plain">\(z\)</span></span><span class="serif-roman">,</span> <span class="serif-roman">for any</span> <span class="math"><span class="math-plain">\(x\)</span></span><span class="serif-roman">,</span> <span class="serif-roman">we have</span> <span class="math"><span class="math-plain">\(y\)</span><span class="math-sign">\(\:&gt;\:\)</span><span class="math-plain">\(z\)</span><span class="math-plain">\(-\)</span><span class="math-plain">\(x\)</span></span><span class="serif-roman">.</span></span> <span class="phrase"><span class="serif-roman">Here</span> <span class="math"><span class="math-plain">\(r\)</span><span class="math-bracket-square">\(\left[ z - x \right]\)</span></span><span class="serif-roman">,</span> <span class="serif-roman">the number of such</span> <span class="math"><span class="math-plain">\(y\)</span></span><span class="serif-roman">,</span> <span class="serif-roman">may be found with a table, filled before the recursion.</span></span> <span class="phrase"><span class="serif-roman">Hence,</span> <span class="math"><span class="math-plain">\(g\)</span><span class="math-bracket-square">\(\left[ z ,\, \mathbb {S} \right]\)</span></span> <span class="serif-roman">may be so defined:</span></span>
</p>
<p class="paragraph">
<span class="phrase"><span class="math"><span class="math-plain">\(g\)</span><span class="math-bracket-square">\(\left[ z ,\, \mathbb {S} \right]\)</span><span class="math-plain">\(\;=\;\)</span><span class="math-triplet">\(\displaystyle\sum\limits _ {x \:\in\: \mathbb {T}}\)</span><span class="math-plain">\(r\)</span><span class="math-bracket-square">\(\left[ z - x \right]\)</span><span class="math-plain">\(;\,\)</span></span></span>
</p>
<p class="paragraph">
<span class="phrase"><span class="serif-roman">The complexity of calling</span> <span class="math"><span class="math-plain">\(g\)</span></span> <span class="serif-roman">is</span> <span class="math"><span class="math-letter">\(\mathscr {O}\)</span><span class="math-bracket-square">\(\left[ N \right]\)</span></span><span class="serif-roman">,</span> <span class="serif-roman">and the complexity of exhausting</span> <span class="math"><span class="math-plain">\(x\)</span></span> <span class="serif-roman">is also</span> <span class="math"><span class="math-letter">\(\mathscr {O}\)</span><span class="math-bracket-square">\(\left[ N \right]\)</span></span><span class="serif-roman">.</span></span> <span class="phrase"><span class="serif-roman">The complexity of recursively calling</span> <span class="math"><span class="math-plain">\(g\)</span></span> <span class="serif-roman">is</span> <span class="math"><span class="math-letter">\(\mathscr {O}\)</span><span class="math-bracket-square">\(\left[ N ^ {2} \right]\)</span></span><span class="serif-roman">,</span> <span class="serif-roman">which overwhelms the complexity of sorting.</span></span> <span class="phrase"><span class="serif-roman">The overall complexity is therefore</span> <span class="math"><span class="math-letter">\(\mathscr {O}\)</span><span class="math-bracket-square">\(\left[ N ^ {2} \right]\)</span></span><span class="serif-roman">.</span></span>
</p>
</div>
<div class="stanza">
<p class="line">
<span class="verse"><code class="mono"># 611. Valid Triangle Number [medium]</code></span>
</p>
<p class="line">
<span class="verse"><code class="mono"># Accepted July 19, 2021</code></span>
</p>
<p class="line">
<span class="verse"><code class="mono">#! /usr/bin/env python3</code></span>
</p>
<p class="line">
<span class="verse"><code class="mono">import typing as TYPE</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span>
</p>
<p class="line">
<span class="verse"><code class="mono">def main():</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse"><code class="mono">choice = [2, 2, 3, 4]</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse"><code class="mono">solution = Solution()</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse"><code class="mono">count = solution.count_triangle_number(<wbr>choice)</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse"><code class="mono">print(&quot;There are&quot;, count, &quot;valid triplets.&quot;)</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse"><code class="mono"># &quot;3&quot;</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse"><code class="mono"># # [2,3,4], [2,3,4], [2,2,3]</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span>
</p>
<p class="line">
<span class="verse"><code class="mono">class Solution:</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse"><code class="mono">def count_triangle_number(self, choice: TYPE.List[int]) -&gt; int:</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">choice = [value for value in choice if value != 0]</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">if not choice: return 0</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">choice.sort()</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">record = dict()</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">for head in range(max(choice) * 2 + 1):</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">record[head] = sum([1 for value in choice if value &lt;= head])</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">record[-1] = 0</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">distinct = list(set(choice))</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">distinct.sort()</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">number = self.count_various(record, distinct)</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">return number</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse"><code class="mono">def count_various(self, record: TYPE.Dict[int, int], distinct: TYPE.List[int]) -&gt; int:</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">if not distinct: return 0</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">small = distinct[0]</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">partial = distinct[1:]</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">number_fixed = self.count_fixed(record, small, partial)</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">number_partial = self.count_various(record, partial)</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">number = number_fixed + number_partial</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">return int(number)</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse"><code class="mono">def count_fixed(self, record: TYPE.Dict[int, int], small: int, distinct: TYPE.List[int]) -&gt; int:</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">number = 0</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">novel_small = record[small] - record[small - 1]</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">number += self.pick_three(novel_small)</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">if not distinct: return number</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">number += (record[small * 2 - 1] - record[small]) * self.pick_two(novel_small)</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">for value in distinct:</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">bound = value + small - 1</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">novel_medium = record[value] - record[value - 1]</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">if (novel_medium == 0): continue</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">total_above = record[bound] - record[value]</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">add_distinct = total_above * novel_medium</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">add_pair_medium = self.pick_two(novel_medium)</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">number += novel_small * (add_distinct + add_pair_medium)</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">return int(number)</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse"><code class="mono">def pick_two(self, number: int) -&gt; int:</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">if (number &lt; 2): return 0</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">return number * (number - 1) / 2</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse"><code class="mono">def pick_three(self, number: int) -&gt; int:</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">if (number &lt; 3): return 0</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">return number * (number - 1) * (number - 2) / 6</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span>
</p>
<p class="line">
<span class="verse"><code class="mono"># # # # # # # # # # # # # # # #</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span>
</p>
<p class="line">
<span class="verse"><code class="mono">main()</code></span>
</p>
</div>
<div class="break">
<span class="phrase">&emsp;</span> <span class="phrase">❦</span> <span class="phrase">&emsp;</span> <span class="phrase">❦</span> <span class="phrase">&emsp;</span> <span class="phrase">❦</span>
</div>
<div class="section">
<p class="paragraph">
<span class="phrase"><span class="serif-roman">❧</span> <em class="serif-italic">code accepted July 19, 2021;</em> <em class="serif-italic">explained August 2, 2021</em></span>
</p>
</div>
</main>